package ind.ericjturley.mcve.configurationproperties;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;

import static org.junit.jupiter.api.Assertions.assertEquals;

@SuppressWarnings("SpringJavaInjectionPointsAutowiringInspection"/*Idea doesn't know about @ConfigurationPropertiesScan yet*/)
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.NONE/*mocked*/,
                classes = TheConfig.class)
class ConfigurationPropertiesTest {

    /**
     * The Java class succeeds
     */
    @Autowired
    PushServicesProperties pushServicesProperties;

    /**
     * This Kotlin data classes fail
     *
     * Oh - actually, they fail whether this is injected or not. See PushServicesProperties1 class
     */
    //@Autowired
    //PushServicesProperties1 pushServicesProperties1;


    @Test
    void justInjectConfigurationPropertiesObjects() {
        assertEquals(-1, pushServicesProperties.getSnsClient().getMaxConnections());
        //assertEquals(-1, pushServicesProperties1.getSnsClient().getMaxConnections());
    }
}